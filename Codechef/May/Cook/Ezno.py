from sys import stdin, stdout
stdin = open("/home/shiva/Learning/1.txt","r")
stdout = open("/home/shiva/Learning/2.txt","w")
ans = {}
ans[2,1] = 1
ans[2,2] = 1
ans[3,1] = 2
ans[3,2] = 3
ans[3,3] = 3
ans[3,4] = 3
ans[3,5] = 2
ans[3,6] = 2
ans[4,1] = 3
ans[4,2] = 6
ans[4,3] = 8
ans[4,4] = 8
ans[4,5] = 7
ans[4,6] = 4
ans[4,7] = 1
ans[5,1] = 4
ans[5,2] = 10
ans[5,3] = 17
ans[5,4] = 21
ans[5,5] = 21
ans[5,6] = 21
ans[5,7] = 13
ans[5,8] = 10
ans[5,9] = 6
ans[5,10] = 4
ans[6,1] = 5
ans[6,2] = 15
ans[6,3] = 30
ans[6,4] = 45
ans[6,5] = 54
ans[6,6] = 54
ans[6,7] = 49
ans[6,8] = 46
ans[6,9] = 21
ans[6,10] = 3
ans[6,11] = 1
ans[7,1] = 6
ans[7,2] = 21
ans[7,3] = 49
ans[7,4] = 87
ans[7,5] = 121
ans[7,6] = 145
ans[7,7] = 145
ans[7,8] = 145
ans[7,9] = 121
ans[7,10] = 92
ans[7,11] = 56
ans[7,12] = 33
ans[7,13] = 20
ans[7,14] = 14
ans[7,15] = 7
ans[7,16] = 3
ans[7,17] = 1
ans[7,18] = 1
ans[8,1] = 7
ans[8,2] = 28
ans[8,3] = 74
ans[8,4] = 148
ans[8,5] = 238
ans[8,6] = 324
ans[8,7] = 367
ans[8,8] = 367
ans[8,9] = 320
ans[8,10] = 258
ans[8,11] = 188
ans[8,12] = 122
ans[8,13] = 69
ans[8,14] = 37
ans[8,15] = 12
ans[8,16] = 6
ans[8,17] = 3
ans[9,1] = 8
ans[9,2] = 36
ans[9,3] = 108
ans[9,4] = 252
ans[9,5] = 454
ans[9,6] = 706
ans[9,7] = 898
ans[9,8] = 1039
ans[9,9] = 1039
ans[9,10] = 1039
ans[9,11] = 869
ans[9,12] = 674
ans[9,13] = 473
ans[9,14] = 309
ans[9,15] = 216
ans[9,16] = 126
ans[9,17] = 66
ans[9,18] = 34
ans[9,19] = 18
ans[9,20] = 8
ans[9,21] = 5
ans[9,22] = 3
ans[10,1] = 9
ans[10,2] = 45
ans[10,3] = 150
ans[10,4] = 375
ans[10,5] = 750
ans[10,6] = 1200
ans[10,7] = 1713
ans[10,8] = 2227
ans[10,9] = 2492
ans[10,10] = 2492
ans[10,11] = 2225
ans[10,12] = 2041
ans[10,13] = 1575
ans[10,14] = 1132
ans[10,15] = 770
ans[10,16] = 571
ans[10,17] = 335
ans[10,18] = 180
ans[10,19] = 90
ans[10,20] = 44
ans[10,21] = 18
ans[10,22] = 12
ans[10,23] = 6
ans[10,24] = 3
ans[10,25] = 1
ans[11,1] = 10
ans[11,2] = 55
ans[11,3] = 202
ans[11,4] = 560
ans[11,5] = 1232
ans[11,6] = 2278
ans[11,7] = 3574
ans[11,8] = 4959
ans[11,9] = 6074
ans[11,10] = 6709
ans[11,11] = 6709
ans[11,12] = 6709
ans[11,13] = 5703
ans[11,14] = 4493
ans[11,15] = 3294
ans[11,16] = 2217
ans[11,17] = 1468
ans[11,18] = 872
ans[11,19] = 514
ans[11,20] = 282
ans[11,21] = 143
ans[11,22] = 65
ans[11,23] = 28
ans[11,24] = 14
ans[11,25] = 7
ans[11,26] = 2
ans[12,1] = 11
ans[12,2] = 66
ans[12,3] = 264
ans[12,4] = 792
ans[12,5] = 1900
ans[12,6] = 3800
ans[12,7] = 6514
ans[12,8] = 9772
ans[12,9] = 13030
ans[12,10] = 15471
ans[12,11] = 16799
ans[12,12] = 16799
ans[12,13] = 15652
ans[12,14] = 13418
ans[12,15] = 10748
ans[12,16] = 8079
ans[12,17] = 5688
ans[12,18] = 3774
ans[12,19] = 2381
ans[12,20] = 1435
ans[12,21] = 817
ans[12,22] = 445
ans[12,23] = 226
ans[12,24] = 108
ans[12,25] = 45
ans[12,26] = 20
ans[12,27] = 3
ans[12,28] = 1
ans[13,1] = 12
ans[13,2] = 78
ans[13,3] = 338
ans[13,4] = 1105
ans[13,5] = 2874
ans[13,6] = 6278
ans[13,7] = 11660
ans[13,8] = 19068
ans[13,9] = 27607
ans[13,10] = 36136
ans[13,11] = 42702
ans[13,12] = 46610
ans[13,13] = 46610
ans[13,14] = 46610
ans[13,15] = 41294
ans[13,16] = 33796
ans[13,17] = 25982
ans[13,18] = 18892
ans[13,19] = 13103
ans[13,20] = 8577
ans[13,21] = 5356
ans[13,22] = 3162
ans[13,23] = 1743
ans[13,24] = 944
ans[13,25] = 470
ans[13,26] = 250
ans[13,27] = 126
ans[13,28] = 63
ans[13,29] = 25
ans[13,30] = 10
ans[13,31] = 4
ans[13,32] = 2
ans[13,33] = 2
ans[13,34] = 2
ans[13,35] = 1
ans[14,1] = 13
ans[14,2] = 91
ans[14,3] = 424
ans[14,4] = 1484
ans[14,5] = 4154
ans[14,6] = 9707
ans[14,7] = 19414
ans[14,8] = 29121
ans[14,9] = 42063
ans[14,10] = 59159
ans[14,11] = 75615
ans[14,12] = 88747
ans[14,13] = 95597
ans[14,14] = 95597
ans[14,15] = 89036
ans[14,16] = 80204
ans[14,17] = 65867
ans[14,18] = 51176
ans[14,19] = 37661
ans[14,20] = 26428
ans[14,21] = 17759
ans[14,22] = 11353
ans[14,23] = 6821
ans[14,24] = 4096
ans[14,25] = 2220
ans[14,26] = 1165
ans[14,27] = 605
ans[14,28] = 310
ans[14,29] = 139
ans[14,30] = 69
ans[14,31] = 27
ans[14,32] = 10
ans[14,33] = 6
ans[14,34] = 2
ans[14,35] = 1
ans[14,36] = 1
ans[14,37] = 1
ans[14,38] = 1
ans[14,39] = 1
ans[15,1] = 14
ans[15,2] = 105
ans[15,3] = 525
ans[15,4] = 1995
ans[15,5] = 5985
ans[15,6] = 15960
ans[15,7] = 34199
ans[15,8] = 64409
ans[15,9] = 107154
ans[15,10] = 171563
ans[15,11] = 233954
ans[15,12] = 296371
ans[15,13] = 342124
ans[15,14] = 368134
ans[15,15] = 368134
ans[15,16] = 368134
ans[15,17] = 324876
ans[15,18] = 281553
ans[15,19] = 222037
ans[15,20] = 171005
ans[15,21] = 122130
ans[15,22] = 84431
ans[15,23] = 54937
ans[15,24] = 34827
ans[15,25] = 20907
ans[15,26] = 12333
ans[15,27] = 7023
ans[15,28] = 3880
ans[15,29] = 2057
ans[15,30] = 1167
ans[15,31] = 564
ans[15,32] = 260
ans[15,33] = 129
ans[15,34] = 62
ans[15,35] = 20
ans[15,36] = 7
ans[15,37] = 1
ans[15,38] = 1
ans[16,1] = 15
ans[16,2] = 120
ans[16,3] = 640
ans[16,4] = 2560
ans[16,5] = 8192
ans[16,6] = 21888
ans[16,7] = 50030
ans[16,8] = 100060
ans[16,9] = 178236
ans[16,10] = 285074
ans[16,11] = 414662
ans[16,12] = 554018
ans[16,13] = 681778
ans[16,14] = 779164
ans[16,15] = 831886
ans[16,16] = 831886
ans[16,17] = 782347
ans[16,18] = 701717
ans[16,19] = 591178
ans[16,20] = 473607
ans[16,21] = 361604
ans[16,22] = 263114
ans[16,23] = 183069
ans[16,24] = 121870
ans[16,25] = 78013
ans[16,26] = 48065
ans[16,27] = 28497
ans[16,28] = 16204
ans[16,29] = 8852
ans[16,30] = 4742
ans[16,31] = 2457
ans[16,32] = 1216
ans[16,33] = 565
ans[16,34] = 259
ans[16,35] = 124
ans[16,36] = 46
ans[16,37] = 21
ans[16,38] = 10
ans[16,39] = 3
from collections import *
for cas in range(int(stdin.readline())):
    base, length = map(int, stdin.readline().strip().split())
    stdout.write(str(ans.get((base,length),0))+'\n')

# def enumerate_good(base, curr, i):
#     curr *= base
#     for d in range(-curr % i, base, i):
#         ncurr = curr + d
#         if ncurr > 0:
#             yield ncurr, i
#             for pair in enumerate_good(base, ncurr, i+1):
#                 yield pair

# from collections import Counter

# B = 16
# for base in range(2,B+1):
#     vals, lengths = zip(*enumerate_good(base, 0, 1))
#     for length, ct in sorted(Counter(lengths).items()):
#         print("ans[{0},{1}] = {2}".format(base, length, ct))
